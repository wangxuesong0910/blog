<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<!--<head>-->
<!--    <meta charset="UTF-8">-->
<!--    <meta http-equiv="X-UA-Compatible" content="IE=edge">-->
<!--    <meta name="viewport" content="width=device-width, initial-scale=1.0">-->
<!--    <link rel="stylesheet" th:href="@{../layui/css/layui.css}">-->
<!--    <title>主页</title>-->

<!--</head>-->
<div th:replace="~{common/head::head}"></div>
<body>


<ul class="layui-nav" lay-filter="demo">
    <img src="/images/tree.png" height="60" width="60" style="margin-left: -3ex;">
    <li class="layui-nav-item layui-this">
        <a href="javascript:;" id="1">Java基础</a>

    </li>

    <li class="layui-nav-item"><a href="javascript:;">数据库</a>
        <dl class="layui-nav-child">
            <dd><a href="javascript:;" id="2">MySQL</a></dd>
            <dd><a href="javascript:;" id="3">MyBatis</a></dd>
            <dd><a href="javascript:;" id="4">Redis</a></dd>
        </dl>
    </li>
    <li class="layui-nav-item"><a href="javascript:;">JavaWeb</a>
        <dl class="layui-nav-child">
            <dd><a href="javascript:;" id="13">HTML</a></dd>
            <dd><a href="javascript:;" id="14">CSS</a></dd>
            <dd><a href="javascript:;" id="15">javascript</a></dd>
            <dd><a href="javascript:;" id="16">Tomcat</a></dd>
            <dd><a href="javascript:;" id="17">Cookie&Session</a></dd>
            <dd><a href="javascript:;" id="18">Servlet</a></dd>
            <dd><a href="javascript:;" id="19">AJAX</a></dd>
            <dd><a href="javascript:;" id="20">JSP</a></dd>
            <dd><a href="javascript:;" id="21">Vue</a></dd>
        </dl>
    </li>
    <li class="layui-nav-item"><a href="javascript:;">Spring全家桶</a>
        <dl class="layui-nav-child">
            <dd><a href="javascript:;" id="5">Spring5</a></dd>
            <dd><a href="javascript:;" id="6">SpringMVC</a></dd>
            <dd><a href="javascript:;" id="7">SpringBoot</a></dd>
            <dd><a href="javascript:;" id="8">SpringCloud</a></dd>
        </dl>
    </li>
    <li class="layui-nav-item"><a href="javascript:;" id="9">Linux</a></li>
    <li class="layui-nav-item"><a href="javascript:;" id="10">Docker</a></li>
    <li class="layui-nav-item"><a href="javascript:;" id="11">Java设计模式</a></li>
    <li class="layui-nav-item"><a href="javascript:;" id="12">JVM虚拟机</a></li>

    <li class="layui-nav-item">
        <a href="javascript:;">解决方案</a>
        <dl class="layui-nav-child">
            <dd><a href="javascript:;">Shiro</a></dd>
            <dd><a href="javascript:;">Ngnix</a></dd>
            <dd><a href="javascript:;">Swagger</a></dd>
            <dd><a href="javascript:;">Druid</a></dd>
            <dd><a href="javascript:;">Dubbo</a></dd>
            <dd><a href="javascript:;">Zookeeper</a></dd>
            <dd><a href="javascript:;">github</a></dd>
        </dl>
    </li>

    <li class="layui-nav-item" lay-unselect="">
        <a href="javascript:;"><img src="/images/github.png" class="layui-nav-img">源码</a>
        <dl class="layui-nav-child">
            <dd><a href="javascript:;">博客源码</a></dd>
            <dd><a href="javascript:;">关心家人源码</a></dd>
            <dd><a href="javascript:;">待续...</a></dd>
        </dl>
    </li>
</ul>


<div class="layui-container">
    常规布局（以中型屏幕桌面为例）：
    <div class="layui-row">
        <div class="layui-col-md9">
            你的内容 9/12
            <div class="layui-tab-content">
                <ul id="view">
                </ul>
            </div>
            <div id="demo1">
                <div id="test-editormd"></div>
            </div>
        </div>


        <div class="layui-col-md3">
            你的内容 3/12
            <div class="layui-panel layui-bg-cyan">
                <div style="padding: 65px 30px;">快速链接处</div>
            </div>
            <ul class="layui-timeline" style="margin-top: 20px;">
                <li class="layui-timeline-item">
                    <i class="layui-icon layui-timeline-axis"></i>
                    <div class="layui-timeline-content layui-text ">
                        <div class="layui-timeline-title layui-bg-red">2018年，layui 5.0 发布。并发展成为中国最受欢迎的前端UI框架（期望）</div>
                    </div>
                </li>
                <li class="layui-timeline-item">
                    <i class="layui-icon layui-timeline-axis"></i>
                    <div class="layui-timeline-content layui-text">
                        <div class="layui-timeline-title layui-bg-orange">2017年，layui 里程碑版本 2.0 发布</div>
                    </div>
                </li>
                <li class="layui-timeline-item">
                    <i class="layui-icon layui-timeline-axis"></i>
                    <div class="layui-timeline-content layui-text">
                        <div class="layui-timeline-title layui-bg-cyan">2016年，layui 首个版本发布</div>
                    </div>
                </li>
                <li class="layui-timeline-item">
                    <i class="layui-icon layui-anim layui-anim-rotate layui-anim-loop layui-timeline-axis"></i>
                    <div class="layui-timeline-content layui-text">
                        <div class="layui-timeline-title">更久前，轮子时代。维护几个独立组件：layer等</div>
                    </div>
                </li>
            </ul>
        </div>
    </div>


</div>


<script th:src="@{../layui/layui.js}" charset="utf-8"></script>
<script th:src="@{https://cdn.bootcss.com/jquery/1.11.3/jquery.min.js}"></script>
<script th:src="@{../editormd/editormd.min.js}"></script>
<script th:src="@{../editormd/lib/marked.min.js}"></script>
<script th:src="@{../editormd/lib/prettify.min.js}"></script>
<script th:src="@{../editormd/lib/raphael.min.js}"></script>
<script th:src="@{../editormd/lib/underscore.min.js}"></script>
<script th:src="@{../editormd/lib/sequence-diagram.min.js}"></script>
<script th:src="@{../editormd/lib/flowchart.min.js}"></script>
<script th:src="@{../editormd/lib/jquery.flowchart.min.js}"></script>

<script>

    layui.use(['element', 'flow', 'laypage'], function () {
        var element = layui.element;
        var flow = layui.flow;
        //一些事件触发：此处是监控导航栏nav 的，如果nav导航栏被点击则触发
        element.on('nav(demo)', function (data) {
            //data.attr('id')：获取点击标签的id值，此处我提前设置为文章的所属gid，也可遍历获取赋值，进行菜单栏设置。不好看，我没弄
            // console.log(data.attr('id'));
            var gid = data.attr('id');
            //此处是nav导航栏的核心，如果不设置目标显示容器为空，那么点击导航栏将不会进行新的流加载显示
            //解决了点击一次，加载过后，再次点击其他导航，页面不显示的问题，实际上是执行查询了的，只是没显示，需要置空
            $("#view").empty();
            //切换文章回到列表，需要将内容置空的同时移除该div的class属性，否则会显示博客文章
            $("#test-editormd").empty().removeClass();

            //layui的流式加载
            flow.load({
                elem: '#view' //指定列表容器
                , done: function (page, next) { //到达临界点（默认滚动触发），触发下一页
                    var lis = [];
                    //以jQuery的Ajax请求为例，请求下一页数据（注意：page是从2开始返回）
                    //此处我的Controller层需要两个值。
                    $.get('/content/queryContentById?page=' + page + '&gid=' + gid, function (res) {
                        //假设你的列表返回在data集合中
                        layui.each(res.data, function (index, item) {
                            lis.push('<div class="layui-row layui-col-space15"  style="margin-top: 20px;">');
                            lis.push('<div class="layui-col-md10">');
                            lis.push('<div class="layui-card"><a href="javascript:getcontent(' + item.tid + ');">');
                            lis.push('<div class="layui-card-header layui-bg-cyan">' + item.title + '</div>');
                            lis.push('<div class="layui-card-body">' + item.tabstract + '</div>');
                            lis.push('</a></div>');
                            lis.push('</div>');
                            lis.push('</div>');
                        });
                        //执行下一页渲染，第二参数为：满足“加载更多”的条件，即后面仍有分页
                        //pages为Ajax返回的总页数，只有当前页小于总页数的情况下，才会继续出现加载更多
                        next(lis.join(''), page < res.pages);
                    });


                }
            });

        });

    });

    function getcontent(tid) {
        //从文章列表跳转也需要将标签置空
        $("#view").empty();

        var lis = [];
        var str = '';
        $.get('/content/queryContent?tid=' + tid, function (data) {
            // console.log(data.data.content);
            var cdata = data.data;

            // lis.push('<div class="layui-card-header layui-bg-cyan">' + cdata.title + '</div>');
            str += '<textarea style="display: none" name="test-editormd-markdown-doc">' + cdata.content + '</textarea>';
            //
            $("#test-editormd").append(str);
            var testEditor = editormd.markdownToHTML("test-editormd", {
                htmlDecode: "style,script,iframe",  // you can filter tags decode
                taskList: true,
                tex: true,  // 默认不解析
                flowChart: true,  // 默认不解析
                sequenceDiagram: true,  // 默认不解析
            });
        });
    };


    // $(function () {
    //     $.ajax({
    //         url: "/content/queryContentById/gid=2",
    //         type: "get",
    //         success: function (data) {
    //             var cdata = data.data;
    //             var str = '';
    //             $.each(cdata, function (i, obj) {
    //                 str += '<div class="layui-row layui-col-space15" style="margin-top: 20px;">';
    //                 str += '<div class="layui-col-md10">';
    //                 str += '<div class="layui-card">';
    //                 str += '<div class="layui-card-header layui-bg-cyan">' + obj.title + '</div>';
    //                 str += '<div class="layui-card-body">' + obj.tabstract + '</div>';
    //                 str += '</div>';
    //                 str += '</div>';
    //                 str += '</div>';
    //             });
    //             $("#view").append(str);
    //         },
    //         dataType: "json"
    //     });
    // });


</script>

</body>
</html>